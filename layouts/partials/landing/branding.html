<div class="branding flex-col w-screen h-screen snap-always snap-start">
    <div class="branding-header flex flex-col lg:flex-row flex-auto w-full lg:h-24 top-0 z-20">
        <header class="bg-tintapod-black opacity-45 w-full">{{ partial "header.html" . }}</header>
    </div>
    <div class="branding-body flex flex-col w-full relative">
        <div class="flex flex-row w-full h-full justify-center items-center">
            <svg
                id="Layer_2"
                data-name="Layer 2"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 234.63 524.5"
                class="w-24 md:w-40 lg:w-52 xl:w-64 2xl:w-72"
            >
                <g id="Layer_1-2" data-name="Layer 1">
                    <g>
                        <path
                            class="logo-icon stroke-1 stroke-tintapod-gray fill-none"
                            d="M181.96,400.33c.82-1.26,1.67-2.49,2.57-3.68-1.45,1.88-2.91,3.76-4.36,5.65,1.93-2.5,4.06-4.8,6.56-6.75-1.88,1.45-3.76,2.91-5.65,4.36,1.54-1.16,3.17-2.15,4.95-2.9-2.22.94-4.44,1.88-6.67,2.81,1.37-.55,2.78-.94,4.25-1.14-2.47.33-4.95.66-7.42,1,1.29-.15,2.56-.15,3.84,0-2.47-.33-4.95-.66-7.42-1,1.5.21,2.94.61,4.34,1.19l-6.67-2.81c1.69.73,3.24,1.68,4.7,2.79l-5.65-4.36c2.11,1.66,3.95,3.6,5.59,5.72-1.45-1.88-2.91-3.76-4.36-5.65,2.59,3.41,4.64,7.17,6.31,11.1-.94-2.22-1.88-4.44-2.81-6.67,2.49,5.98,4.09,12.27,4.99,18.68-.33-2.47-.66-4.95-1-7.42.99,7.48,1,15.03.01,22.51.33-2.47.66-4.95,1-7.42-.96,6.92-2.76,13.67-5.46,20.12l2.81-6.67c-2.48,5.79-5.65,11.21-9.49,16.2,1.45-1.88,2.91-3.76,4.36-5.65-3.8,4.84-8.16,9.18-13.02,12.95,1.88-1.45,3.76-2.91,5.65-4.36-4.45,3.4-9.29,6.22-14.44,8.41,2.22-.94,4.44-1.88,6.67-2.81-5.4,2.25-11.05,3.78-16.84,4.57,2.47-.33,4.95-.66,7.42-1-5.86.76-11.76.75-17.62-.01,2.47.33,4.95.66,7.42,1-6.02-.82-11.88-2.42-17.49-4.75,2.22.94,4.44,1.88,6.67,2.81-5.89-2.49-11.4-5.75-16.47-9.65,1.88,1.45,3.76,2.91,5.65,4.36-5.32-4.16-10.05-8.97-14.2-14.28,1.45,1.88,2.91,3.76,4.36,5.65-5.24-6.79-9.47-14.26-12.82-22.15l2.81,6.67c-4.66-11.13-7.53-22.87-9.13-34.81.33,2.47.66,4.95,1,7.42-2-15.41-2.14-31.15-.07-46.56-.33,2.47-.66,4.95-1,7.42,2.28-16.55,7.19-32.53,13.65-47.9l-2.81,6.67c6.23-14.76,13.74-28.92,21.17-43.1,8.64-16.47,16.79-33.05,23.84-50.27,15.51-37.88,20.95-79.41,15.67-120.01-2.12-16.25-5.02-32.23-9.36-48.04-4.52-16.43-10.22-32.52-16.66-48.3-1.83-4.5-3.67-8.81-7.18-12.31-4.36-4.36-9.98-6.86-16.02-7.67-5.1-.69-9.71-.1-14.46,1.9-5.33,2.25-10.6,6.13-13.34,11.42-5.87,11.31-11.75,22.62-17.62,33.92-9.36,18.02-18.72,36.05-28.09,54.07-2.15,4.14-4.3,8.27-6.44,12.41-3.44,6.63-4.83,14.16-2.81,21.5,1.78,6.47,6.79,13.49,12.82,16.68,6.48,3.42,14.32,5.14,21.5,2.81,6.72-2.18,13.32-6.36,16.68-12.82,5.87-11.31,11.75-22.62,17.62-33.92,9.36-18.02,18.72-36.05,28.09-54.07,2.15-4.14,4.3-8.27,6.44-12.41-17-2.22-34-4.44-51-6.67,11.55,28.34,20.8,57.81,24.93,88.2l-1-7.42c2.59,19.5,2.95,39.24.38,58.76.33-2.47.66-4.95,1-7.42-2.67,19.83-8.39,39-16.14,57.41.94-2.22,1.88-4.44,2.81-6.67-6.53,15.45-14.35,30.28-22.13,45.13-8.64,16.47-16.86,33.05-23.72,50.36-7.11,17.93-11.27,36.37-13.23,55.56-1.16,11.35-1.11,22.85-.09,34.21,1.29,14.41,3.53,28.95,8.33,42.65,4.09,11.65,9.24,23.26,16.54,33.29,3.96,5.44,8.11,10.86,12.87,15.64,4.59,4.6,9.8,8.61,15.05,12.41,8.34,6.04,18.17,10.47,27.99,13.42,5.96,1.79,12.09,2.55,18.26,3.31,3.76.47,7.54.66,11.33.5,9.69-.39,19.78-1.93,28.86-5.49,5.57-2.19,11.21-4.49,16.36-7.59,5.52-3.32,10.69-7.37,15.51-11.62,5.79-5.1,10.55-11.16,15.08-17.38,3.08-4.22,5.66-8.78,7.77-13.56,2.94-6.65,5.71-13.3,7.33-20.39,1.59-6.96,2.55-14.16,2.93-21.28.25-4.66.12-9.35-.4-13.99-.75-6.66-1.59-13.38-3.4-19.85-1.69-6.04-4.16-11.94-6.88-17.56-2.57-5.31-6.09-9.87-9.8-14.46-3.38-4.18-7.71-7.55-12.15-10.54-3.06-2.06-6.7-3.36-10.07-4.68-1.27-.5-2.52-.88-3.87-1.12-3.56-.65-7.41-1.38-11.09-1.14-3.6.24-7.64.6-11.16,1.78-7.9,2.63-13.65,6.24-19.9,11.73-4.75,4.18-8.59,9.59-12.01,14.85-3.83,5.9-4.65,14.84-2.81,21.5,1.78,6.47,6.79,13.49,12.82,16.68,6.48,3.42,14.32,5.14,21.5,2.81,7.11-2.3,12.58-6.51,16.68-12.82h0Z"
                        />
                    </g>
                </g>
            </svg>
        </div>
        <div
            class="flex flex-row w-full h-full justify-center items-center absolute z-5 tracking-widest bg-transparent text-tintapod-gray font-normal"
        >
            <h1 class="branding-text text-4xl lg:text-7xl opacity-0">{{ site.Title }}</h1>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" type="text/javascript"></script>
    <script>
        /**
         * As soon as the page loads, start a timer to allow the animation to play
         * Then scroll automatically upto a point
         * Then stop scrolling automatically
         */
        // Source: https://stackoverflow.com/questions/31223341/detecting-scroll-direction
        let scrollerId;
        let autoScrollerId;
        let lastScrollTop = 0;

        function computeHeight() {
            let brandingHeader = document.querySelector(".branding-header");
            let brandingBody = document.querySelector(".branding-body");

            brandingBody.style.height = `${window.innerHeight - brandingHeader.offsetHeight}px`;
        }

        function stopScroll() {
            clearInterval(scrollerId);
        }

        function startScroll() {
            let id = setInterval(function () {
                window.scrollBy(0, 2);
                if (window.innerHeight + window.scrollY === document.body.offsetHeight) {
                    stopScroll();
                }
            }, 10);

            return id;
        }

        function handleScroll() {
            if (window.scrollY === 0) {
                setTimeout(function () {
                    scrollerId = startScroll();
                }, 3000);
            }
        }

        function autoScrollToWelcomeVid() {
            if (document.querySelector(".branding").getBoundingClientRect().top === 0) {
                autoScrollerId = setTimeout(function () {
                    document.getElementById("our-story").scrollIntoView({
                        behavior: "smooth",
                    });
                }, 3100);
            }
        }

        function handleAnimateLogo() {
            anime({
                delay: function (el, i) {
                    return i * 500;
                },
                direction: "alternate",
                duration: 2000,
                easing: "easeInOutSine",
                fill: "#C7C8C8",
                loop: false,
                opacity: 0.33,
                strokeDashoffset: [anime.setDashoffset, 0],
                targets: "#Layer_2 path",
            });
        }

        function revealBrandingText() {
            anime({
                delay: function (el, i) {
                    return i * 250;
                },
                direction: "alternate",
                duration: 3000,
                easing: "easeInOutQuart",
                loop: false,
                opacity: 0.7,
                targets: ".branding-text",
            });
        }

        window.addEventListener("load", function () {
            computeHeight();
            handleAnimateLogo();
            revealBrandingText();
            autoScrollToWelcomeVid();
            /*  handleScroll();  */
        });

        window.addEventListener("resize", function () {
            computeHeight();
        });

        window.addEventListener(
            "scroll",
            /*  function () {
                let st = window.pageYOffset || document.documentElement.scrollTop; // Credits: "https://github.com/qeremy/so/blob/master/so.dom.js#L426"

                if (st > lastScrollTop) {
                    if (st === 200) {
                        stopScroll();
                    }
                } else if (st < lastScrollTop) {
                    stopScroll();
                }
                lastScrollTop = st <= 0 ? 0 : st; // For Mobile or negative scrolling
            },  */
            function() {
                clearTimeout(autoScrollerId);
            },
            false
        );
    </script>
</div>
